name: AFEOL PR Checklist Validator

on:
  pull_request:
    types: [opened, edited, synchronize]

jobs:
  checklist:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Validate PR description
        uses: actions/github-script@v7
        with:
          script: |
            const checklist = [
              "No telemetry, analytics, or tracking",
              "No sensitive data included",
              "Changes respect privacy/anonymity principles",
              "English is the primary language of added text",
              "PR targets the dev branch"
            ];

            const body = context.payload.pull_request.body || "";

            let missing = [];

            for (const item of checklist) {
              if (!body.includes(item)) {
                missing.push(item);
              }
            }

            if (missing.length > 0) {
              core.setFailed(
                "PR checklist is incomplete. Missing:\n" +
                missing.map(i => "- " + i).join("\n")
              );
            } else {
              core.notice("Checklist OK.");
            }
